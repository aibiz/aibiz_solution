{% extends 'layouts/base.html' %}
{% load static %}
{% block title %}Problem Add{% endblock %}
<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <div>
        <h1>Modify Data</h1>
    </div>

    <main class="main" id="top">
        <form id="inputForm" method="post" action="">
            {% csrf_token %}
            <input type="hidden" id="id" value="{{ data.id }}">
            <div class="mb-3">
                <label class="form-label" for="recipe_id">Recipe ID</label>
                <input type="text" class="form-control" id="recipe_id" name="recipe_id" value="{{ data.recipe_id }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="recipe_name">Recipe_Name</label>
                <input type="text" class="form-control" id="recipe_name" name="recipe_name" value="{{ data.recipe_name }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="revision_no">Revision No</label>
                <input type="text" class="form-control" id="revision_no" name="revision_no" value="{{ data.revision_no }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="equip_name">Equipment</label>
                <input type="text" class="form-control" id="equip_name" name="equip_name" value="{{ data.equip_name }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="chamber_name">Chamber</label>
                <input type="text" class="form-control" id="chamber_name" name="chamber_name" value="{{ data.chamber_name }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="sensor_cd">Sensor Code</label>
                <input type="text" class="form-control" id="sensor_cd" name="sensor_cd" value="{{ data.sensor_cd }}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="sensor_name">Sensor</label>
                <input type="text" class="form-control" id="sensor_name" name="sensor_name" value="{{ data.sensor_name }}">
            </div>
            <div class="mb-3">
                <button class="btn btn-falcon-primary w-8 mt-3" type="button" onclick="update_Recipe()">Confirm</button>
                <button class="btn btn-falcon-primary w-8 mt-3" type="button" onclick="delete_Recipe()">Delete</button>
                <button class="btn btn-falcon-primary w-8 mt-3" type="button" onclick="back()">Back</button>
            </div>
        </form>
    </main>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script language="JavaScript">
    function update_Recipe(){

        var url = "/master/updaterecipe";
        //console.log(url);
        var form = $('#inputForm')[0];
        var formData = new FormData(form);
        formData.append("id", document.getElementById('id').value);

        $.ajax({
            type : 'POST',
            url : url,
            headers: { "X-CSRFToken": getCookie("csrftoken") },
            data : formData,
            cache: false,
            contentType: false,
            processData: false,
            error: function(request,status,error){
                 alert("code:"+request.status+"\n"+"error:"+error);
            },
            success : function(result){
                if (result.success == false) {
                        alert(result.message);
                }
                else {
                    alert(result.message);
                    location.href='/master'
                }
            }
        });
    }

    function delete_Recipe(){

        var url = "/master/deleterecipe";

        var formData = new FormData();
        formData.append("id", document.getElementById('id').value);

        $.ajax({
            type : 'POST',
            url : url,
            headers: { "X-CSRFToken": getCookie("csrftoken") },
            data : formData,
            cache: false,
            contentType: false,
            processData: false,
            error: function(request,status,error){
                 alert("code:"+request.status+"\n"+"error:"+error);
            },
            success : function(result){
                if (result.success == false) {
                    alert(result.message);
                }
                else {
                    alert(result.message);
                    location.href='/master'
                }
            }
        });
    }

    function back()
    {
        location.href='/master'
    }
</script>
{% endblock javascripts %}